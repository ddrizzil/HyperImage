"""
Digital X-ray Radiography (DR) technique data definition.
"""

# Data for Digital X-ray Radiography (DR) reference page
digital_x_ray_radiography_dr_data = {'one_line_summary': 'Digital X-ray radiography uses electronic detectors (flat-panel detectors or computed radiography plates) instead of photographic film to capture X-ray transmission images. The technique provides immediate image feedback, superior dynamic range, digital archiving, and advanced image processing capabilities while maintaining the fundamental physics of traditional radiography. DR has largely replaced film-based systems in modern conservation labs due to improved workflow efficiency and image quality.', 'abstract': 'Digital X-ray radiography uses electronic detectors (flat-panel detectors or computed radiography plates) instead of photographic film to capture X-ray transmission images. The technique provides immediate image feedback, superior dynamic range, digital archiving, and advanced image processing capabilities while maintaining the fundamental physics of traditional radiography. DR has largely replaced film-based systems in modern conservation labs due to improved workflow efficiency and image quality.', 'physics_principle': 'Digital radiography operates on the same physical principles as film radiography - differential X-ray attenuation through materials of varying density and atomic composition. The key difference lies in detection: instead of photographic emulsion, digital detectors use either scintillator-photodiode arrays (direct digital radiography, DDR) or photostimulable phosphor plates (computed radiography, CR). X-ray photons are converted to visible light in a scintillator layer, then to electrical charge in a photodiode array or stored in phosphor crystals. The electronic signal is digitized to create a grayscale image where pixel values represent X-ray transmission intensity.', 'instruments_components': '**Source:**\nX-ray tube (identical to film radiography systems). Tungsten anode; oil or water-cooled; constant potential or pulsed. Energy range: 40-150 kV (same as film systems). Power range: 100-500 W for portable; up to 5 kW for fixed installations. Beam characteristics: Polychromatic bremsstrahlung; cone beam; focal spot 0.3-3 mm.\n\n**Detector:**\nFlat-panel detector (FPD) - amorphous silicon (a-Si) or amorphous selenium (a-Se), Computed radiography (CR) - photostimulable phosphor plates, or CCD/CMOS with scintillator. Sensitive to 20-150 keV X-rays. Efficiency: Flat-panel indirect 40-70% DQE; Direct conversion 60-80%; CR 30-50%. Time resolution: Flat-panel 3-30 fps possible; CR single-shot, ~1 min read time.\n\n**Critical Components:**\n- Flat-panel detector or CR cassette with reader\n- High-voltage X-ray generator with precise control\n- Anti-scatter grid (removable, ratio 8:1 to 15:1)\n- Detector calibration phantom (flat-field correction)\n- Acquisition computer with DICOM-compatible software\n- Network storage and PACS integration\n- Radiation shielding enclosure\n\n**Typical Configuration:**\n**Modern DR setup:** Flat-panel detector (43 × 43 cm active area, 139 μm pixel pitch) mounted on adjustable stand or behind object support. X-ray tube at 1.5-2 m distance. Detector connected to acquisition workstation via Ethernet or fiber optic. Real-time preview during positioning, <5 second image acquisition time. Automated exposure control (AEC) optimizes kV/mAs. Images exported as 16-bit TIFF or DICOM.', 'resolution_detection': "**Spatial Resolution:**\nLateral Resolution: 0.05-0.2 mm (detector-dependent); typically 100-200 μm for flat-panel detectors, 50-100 μm for CR plates. Depth Resolution: No depth resolution - 2D projection (same as film radiography). Limiting factors: Detector pixel pitch (100-200 μm typical), Scintillator thickness (thicker = better efficiency but worse resolution), X-ray focal spot size (0.3-3 mm), Geometric magnification and unsharpness, Electronic noise in readout circuitry.\n\n**Interaction Depth:**\nInteraction depth is identical to film radiography - DR is a transmission technique sampling entire object thickness. Detection mechanism does not affect X-ray penetration, only signal capture efficiency. Canvas/textile: Full thickness (0.5-2 mm), complete transmission. Wood panels: Up to 5 cm at 80-100 kV, DR's high dynamic range better visualizes grain in thick panels. Paint layers (lead white): All layers imaged, superior to film for revealing subtle density variations. Bronze sculptures: 0.5-3 cm depending on kV, digital's wider latitude shows internal structure better than film. Stone (marble, limestone): 2-10 cm, high kV (>150 kV) required; DR captures details film misses.\n\n**Detection Limits:**\nCan detect <1% density difference (superior to film's ~2%); 0.05-0.5 mm thickness changes. Dynamic range: Flat-panel 10⁴ (14-bit ADC); CR 10⁴-10⁵ (16-bit); Film only 10²-10³. Signal-to-noise: DQE 40-70% at low spatial frequencies for modern flat-panel; CR 20-40%; Film 10-30%.", 'sample_requirements': "**Destructiveness:** non-destructive\n\n**Portability:** transportable\n\n**Sample Preparation:**\n['No sampling required - completely non-destructive', 'Identical to film radiography - object positioned on easel or table, detector placed behind or beneath object', 'Detector must be protected from mechanical damage (use protective cover if in direct contact)', 'No preparation required. Remove metal supports that would block X-rays', 'Protect detector surface from scratches and impact', 'Avoid exposing detector to excessive scatter radiation when not acquiring', 'Keep detector dry (moisture damages electronics)']", 'measurement_protocol': {'preparation': ["['No sampling required - completely non-destructive', 'Identical to film radiography - object positioned on easel or table, detector placed behind or beneath object', 'Detector must be protected from mechanical damage (use protective cover if in direct contact)', 'No preparation required. Remove metal supports that would block X-rays', 'Protect detector surface from scratches and impact', 'Avoid exposing detector to excessive scatter radiation when not acquiring', 'Keep detector dry (moisture damages electronics)']"], 'data_collection': ['**STEP 1: System Calibration and Quality Assurance (10-15 minutes)**\n- Power on detector and allow warm-up (5-15 minutes)\n- Perform flat-field calibration by exposing detector without object at standard settings\n- Verify dark-field correction (detector noise with no exposure)\n- Check image quality metrics using test phantom\n- Critical parameters: Flat-field uniformity <5% variation, Dark current within specifications, No dead pixels\n\n**STEP 2: Object and Detector Positioning (5-10 minutes)**\n- Position object on support structure\n- Place detector behind object with minimal air gap (reduces scatter and geometric unsharpness)\n- Align X-ray tube perpendicular to object center\n- Measure and record source-to-detector distance (SDD) and object-to-detector distance (ODD)\n- Critical parameters: Detector protected from damage, Object stable, Alignment perpendicular\n\n**STEP 3: Exposure Parameter Selection (2-5 minutes)**\n- Select kV based on object thickness and material (40-60 kV for thin paintings, 80-100 kV for wood panels, 120-150 kV for metals)\n- Set mAs to achieve proper detector exposure (typically 2-10 mAs for flat-panel, 5-20 mAs for CR)\n- Use automatic exposure control (AEC) if available\n- Consider using lower dose than film (DR is more efficient)\n- Critical parameters: kV appropriate for penetration, Detector exposure index in optimal range\n\n**STEP 4: Preview/Scout Image (Optional, 1-2 minutes)**\n- Acquire low-dose preview image to verify positioning and coverage\n- Adjust collimation to include only region of interest (reduces scatter)\n- Make any necessary positioning corrections\n- Critical parameters: Full region of interest visible, No critical features cut off\n\n**STEP 5: Image Acquisition (0.5-2 minutes)**\n- Clear room of personnel\n- Initiate exposure from shielded control area\n- Digital detector acquires image in <5 seconds\n- For CR, expose plate and transfer to reader within 1 hour (latent image fades over time)\n- Critical parameters: No motion during exposure, Proper technique selected, Detector ready to acquire\n\n**STEP 6: Image Review and Optimization (2-5 minutes)**\n- Immediately review image on workstation monitor\n- Check for proper exposure (histogram analysis), adequate contrast, no motion blur\n- Adjust window/level for optimal visualization\n- If unsatisfactory, repeat with adjusted parameters\n- Digital allows non-destructive re-processing unlike film\n- Critical parameters: Exposure index within target range, No artifacts, Diagnostic quality achieved\n\n**STEP 7: Image Processing and Enhancement (5-15 minutes)**\n- Apply processing algorithms as needed: edge enhancement, noise reduction, contrast optimization\n- Create multiple processed versions for different visualization needs (bone/soft tissue equivalent for art)\n- Annotate image with measurements, labels, ROI markers\n- Critical parameters: Processing preserves diagnostic information, Original raw data retained\n\n**STEP 8: Image Export and Archiving (5-10 minutes)**\n- Export images in lossless format (16-bit TIFF, PNG, or DICOM)\n- Archive raw detector data separately\n- Upload to PACS or institutional database with complete metadata (exposure parameters, object ID, date, operator)\n- Create presentation-quality JPEG for reports if needed'], 'calibration': ['**Standards used:** Flat-field correction phantom (uniform X-ray field), Contrast-detail phantom for image quality assessment, Line-pair resolution test pattern, Dose calibration using ion chamber.\n\n**Frequency:** Daily flat-field and dark-field correction; weekly QA phantom; quarterly dose calibration.\n\n**Procedure:** Flat-field: expose detector without object at standard settings; system divides all subsequent images by flat-field to correct gain non-uniformities. Dark-field: acquire image with no X-ray exposure to measure electronic noise and offset.']}, 'data_outputs': '**Raw Data Format:**\n**File Formats:** DICOM (.dcm) - standard medical imaging format, Raw detector data (vendor-specific), 16-bit TIFF, PNG (16-bit), JPEG2000 (lossless).\n\n**Data Structure:** 2D grayscale image array; pixel values represent relative X-ray attenuation (inverted log scale).\n\n**Typical File Sizes:** 8-32 MB per image (2K × 2K at 16-bit = 8 MB; 3K × 3K = 18 MB).', 'data_analysis_pipeline': {'preprocessing': '- Flat-field correction: Divide raw image by stored flat-field reference to correct detector gain variations and vignetting. Applied automatically by most systems. Software: Built-in to acquisition software\n- Dark-field subtraction: Subtract dark current noise measured with no X-ray exposure. Corrects for electronic offset and thermal noise. Software: Built-in\n- Defective pixel correction: Replace known bad pixels with interpolated values from neighbors. Uses stored pixel map. Software: Built-in or ImageJ\n- Logarithmic transformation (optional): Convert pixel values to optical density equivalent: OD = -log(PV/PV_max). Makes digital images appear similar to film. Software: ImageJ, MATLAB\n- Histogram equalization: Spread pixel value distribution across full dynamic range to maximize contrast. Use judiciously - can amplify noise. Software: ImageJ, Photoshop\n- Spatial frequency filtering: Apply unsharp mask for edge enhancement or Gaussian blur for noise reduction. Adjust based on image content. Software: ImageJ, MATLAB, Photoshop', 'analysis_workflow': "**STEP 1: Image Import and DICOM Header Review**\n- Load DICOM file into viewer. Verify exposure parameters in header (kV, mAs, SDD, pixel size). Extract metadata for documentation.\n\n**STEP 2: Initial Window/Level Adjustment**\n- Set window width (contrast) and level (brightness) to optimize feature visibility. Digital's wide dynamic range allows visualization of both dense and thin features with different settings.\n\n**STEP 3: Feature Identification and Segmentation**\n- Systematically identify structural elements, pigment distributions, and anomalies. Use ROI tools to measure pixel statistics in regions of interest. Compare profiles across features.\n\n**STEP 4: Quantitative Analysis (Optional)**\n- Measure gray values in calibrated regions. Calculate relative densities. Generate line profiles showing attenuation along paths. Compute CNR for feature detectability assessment. Equation: μ_eff = ln(PV_bg/PV_roi)/t\n\n**STEP 5: Image Processing and Enhancement**\n- Create multiple processed versions: high-contrast for structure, edge-enhanced for fine detail, noise-reduced for low-contrast features, pseudo-color for presentation.\n\n**STEP 6: Comparison with Other Modalities**\n- Register DR image to visible, UV, IR, and XRF images. Overlay or side-by-side comparison. Identify features unique to each modality.\n\n**STEP 7: 3D Reconstruction (If Multiple Views Available)**\n- If radiographs acquired from multiple angles, use tomosynthesis or limited-angle tomography algorithms to reconstruct depth information. Uses Radon transform inversion."}, 'artifacts_troubleshooting': '**Troubleshooting:**\n- Detector uniformity (flat-field) within ±5% across field\n- No dead or stuck pixels (>5 adjacent = artifact concern)\n- SNR and CNR meet specifications for application\n- Exposure indicator in target range (prevents over/under-exposure)\n- Spatial resolution verified with line-pair phantom (>3 lp/mm visible)\n- Proper DICOM header information (patient/object ID, exposure params)\n- Common artifacts: Dead pixels (individual pixels always at max or min value), Lines or streaks (TFT row/column defects), Ghost images (residual signal from previous high-dose exposure), Aliasing/moiré patterns (interference between object structure and pixel grid), Lag (temporal blurring from slow scintillator decay)\n- Troubleshooting: Image too bright/overexposed (reduce exposure, check calibration, verify AEC sensor positioning), Image too dark/underexposed (increase exposure, verify generator output, check detector gain calibration), Grainy/noisy image (increase mAs if object tolerates higher dose, apply noise reduction filter, check detector temperature), Blurred image (shorter exposure time, ensure object stability, use smaller focal spot), Vertical or horizontal lines (pixel correction map; if severe, detector repair/replacement needed), Ghost from previous exposure (wait longer between exposures, perform detector flush/clearing cycle)', 'multimodal_pairings': '**Complementary Techniques:**\n\n- x-ray-radiography-film\n\n- ct-tomography\n\n- ma-xrf\n\n- irr-nir', 'strengths_limitations': {'strengths': ['See technique documentation'], 'limitations': ['See technique documentation']}, 'references': [{'citation': "Sonoda, M., M. Takano, J. Miyahara, and H. Kato. 1983. 'Computed Radiography Utilizing Scanning Laser Stimulated Luminescence.' Radiology 148 (3): 833-838.", 'doi': '10.1148/radiology.148.3.6878708'}, {'citation': "Antonuk, L. E. 2002. 'Electronic Portal Imaging Devices: A Review and Historical Perspective of Contemporary Technologies and Research.' Physics in Medicine and Biology 47 (6): R31-R65.", 'doi': '10.1088/0031-9155/47/6/201'}, {'citation': "Dik, J., et al. 2012. 'Advanced X-ray Imaging Techniques in Art History.' MRS Bulletin 37 (6): 579-586.", 'doi': '10.1557/mrs.2012.124'}], 'lab_checklist': ['Detector uniformity (flat-field) within ±5% across field', 'No dead or stuck pixels (>5 adjacent = artifact concern)', 'SNR and CNR meet specifications for application', 'Exposure indicator in target range (prevents over/under-exposure)', 'Spatial resolution verified with line-pair phantom (>3 lp/mm visible)', 'Proper DICOM header information (patient/object ID, exposure params)', 'Common artifacts: Dead pixels (individual pixels always at max or min value), Lines or streaks (TFT row/column defects), Ghost images (residual signal from previous high-dose exposure), Aliasing/moiré patterns (interference between object structure and pixel grid), Lag (temporal blurring from slow scintillator decay)', 'Troubleshooting: Image too bright/overexposed (reduce exposure, check calibration, verify AEC sensor positioning), Image too dark/underexposed (increase exposure, verify generator output, check detector gain calibration), Grainy/noisy image (increase mAs if object tolerates higher dose, apply noise reduction filter, check detector temperature), Blurred image (shorter exposure time, ensure object stability, use smaller focal spot), Vertical or horizontal lines (pixel correction map; if severe, detector repair/replacement needed), Ghost from previous exposure (wait longer between exposures, perform detector flush/clearing cycle)'], 'keywords': ['digital radiography', 'flat-panel detector', 'computed radiography', 'X-ray imaging', 'non-destructive', 'DICOM', 'high dynamic range', 'instant results', 'conservation', 'cultural heritage']}
