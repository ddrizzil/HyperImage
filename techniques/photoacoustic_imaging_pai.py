"""
Photoacoustic Imaging (PAI) technique data definition.
"""

# Data for Photoacoustic Imaging (PAI) reference page
photoacoustic_imaging_pai_data = {'one_line_summary': 'Photoacoustic imaging is a hybrid non-invasive technique that combines optical excitation with acoustic detection to image subsurface structures with high resolution and penetration depth. Short laser pulses are absorbed by chromophores in the material, causing thermoelastic expansion that generates ultrasonic pressure waves. These acoustic waves are detected by ultrasound transducers and reconstructed into depth-resolved images. In cultural heritage, PAI reveals subsurface paint layers, pigment distributions, underdrawings, and structural damage beneath opaque surfaces, achieving millimeter to centimeter penetration depths impossible with purely optical techniques while maintaining sub-millimeter spatial resolution.', 'abstract': 'Photoacoustic imaging is a hybrid non-invasive technique that combines optical excitation with acoustic detection to image subsurface structures with high resolution and penetration depth. Short laser pulses are absorbed by chromophores in the material, causing thermoelastic expansion that generates ultrasonic pressure waves. These acoustic waves are detected by ultrasound transducers and reconstructed into depth-resolved images. In cultural heritage, PAI reveals subsurface paint layers, pigment distributions, underdrawings, and structural damage beneath opaque surfaces, achieving millimeter to centimeter penetration depths impossible with purely optical techniques while maintaining sub-millimeter spatial resolution.', 'physics_principle': "Photoacoustic imaging exploits the photoacoustic effect: pulsed light (typically nanosecond laser pulses) is absorbed by chromophores in the material, causing rapid local heating (μs-ms timescale). This thermal expansion generates pressure waves (ultrasound) that propagate through the material. Ultrasonic transducers on the surface detect these waves. The time-of-flight of acoustic signals encodes depth information: deeper absorbers generate delayed signals. By scanning the laser beam or transducer array, 2D/3D images are reconstructed showing absorption distribution as a function of depth. PAI overcomes optical scattering limitations (only ballistic photons needed for absorption) while providing ultrasound's penetration depth and acoustic resolution.", 'instruments_components': '**Source:**\nPulsed laser (Nd:YAG, OPO, or diode laser). Nanosecond pulses (3-20 ns typical); Q-switched Nd:YAG at 532 nm or 1064 nm common; OPO tunable 400-2000 nm for spectroscopic PAI. Visible: 400-700 nm (pigment absorption); NIR: 700-1200 nm (deeper penetration); tunable for multispectral PAI. Pulse energy: 1-100 mJ per pulse; fluence at surface: 5-20 mJ/cm² (below damage threshold). Collimated or weakly focused beam; 1-10 mm spot size typical; uniform illumination preferred for quantification.\n\n**Detector:**\nSingle-element ultrasound transducer (scanning), Linear ultrasound array (1D), or 2D ultrasound array (for 3D imaging). Ultrasonic frequencies: 1-100 MHz (1 MHz = cm-scale depth, low resolution; 50 MHz = mm-scale, high resolution). Piezoelectric transducers: 50-80% conversion efficiency; CMUT (capacitive micromachined): 30-60%. Time resolution: Nanosecond (limited by laser pulse duration and acoustic transit time).\n\n**Critical Components:**\n- Pulsed laser with stable energy output (±5% shot-to-shot variation)\n- High-sensitivity ultrasound transducer (center frequency 5-50 MHz typical)\n- Low-noise preamplifier and data acquisition system (12-14 bit, 100-500 MS/s)\n- Acoustic coupling medium (ultrasound gel, water bath, or dry coupling pad)\n- Motorized scanning stage (10 μm positioning precision)\n- Trigger synchronization (laser pulse → transducer acquisition)\n- Vibration isolation (acoustic signals are low amplitude)\n- Safety interlocks (Class 4 laser system)\n\n**Typical Configuration:**\n**Standard PAI system:** Q-switched Nd:YAG laser (532 nm, 5 ns pulse, 10 Hz repetition rate, 20 mJ/pulse) coupled via fiber to beam homogenizer. Illumination spot 5 mm diameter on sample surface. Single-element focused ultrasound transducer (10 MHz center, 6 mm focal distance) positioned in contact with sample via ultrasound gel. Laser pulse triggers oscilloscope or digitizer (200 MS/s, 12-bit). Sample on XY motorized stage (scanning 50 × 50 mm, 200 μm step size). Acquire A-scan (depth profile) at each position. Reconstruct 3D volume (x, y, z) showing acoustic amplitude. System in light-tight enclosure with laser safety interlocks.', 'resolution_detection': '**Spatial Resolution:**\nLateral Resolution: 50-500 μm (depends on acoustic frequency; higher frequency = better resolution but less depth). Depth Resolution: 15-100 μm axial resolution (depends on transducer bandwidth; 50 MHz → ~30 μm; 10 MHz → ~150 μm). Limiting factors: Acoustic frequency: higher frequency improves resolution but reduces penetration (acoustic attenuation ∝ f²), Transducer bandwidth: broader bandwidth = better axial resolution, Acoustic aberrations from material heterogeneity, Optical fluence at depth: deep absorbers receive less light (exponential decay), Acoustic scattering and attenuation in material.\n\n**Interaction Depth:**\nPAI penetration depth is limited by optical attenuation in the excitation path (photons must reach absorbers) and acoustic attenuation in detection path (ultrasound propagates back to surface). Typical depths: 1-5 mm in paint layers, up to 10-20 mm in less absorbing/scattering media like wood. Much deeper than purely optical techniques (e.g., OCT limited to ~1-2 mm). Near-infrared excitation (700-1200 nm) maximizes depth due to reduced scattering. Oil paint layers: 1-3 mm typical, up to 5 mm. Tempera/gouache: 2-4 mm, less scattering than oil; better depth penetration. Canvas and wood substrates: 5-20 mm, lower absorption than paint; excellent ultrasound transmission. Varnish layers: Transparent to PAI (penetrated easily), varnish scatters light but transmits ultrasound - advantage over OCT. Murals/frescoes: 3-10 mm into plaster, can image through lime layers to detect subsurface structure. Paper and parchment: 0.5-2 mm (thin substrates), can image through sheet to detect watermarks, repairs.\n\n**Detection Limits:**\n~1-10 μM concentration of strong absorbers (e.g., hemoglobin in biomedical); pigments: ~0.1-1% volume fraction. Dynamic range: 10³-10⁴ (limited by detector dynamic range and laser energy variation). Signal-to-noise: SNR 20-100:1 typical for superficial layers; 5-20:1 at maximum depth.', 'sample_requirements': "**Destructiveness:** non-destructive\n\n**Portability:** laboratory-only\n\n**Sample Preparation:**\n['Sampling required: No - in-situ or sample size: few cm² to meters² (depends on system); no size limits in principle', 'For benchtop: place painting or sample horizontally on stage. For handheld: position probe against vertical surface (mural, panel)', 'Apply acoustic coupling medium (ultrasound gel or dry coupling pad) between transducer and surface', 'Ensure good contact without air gaps', 'Clean surface (remove loose dirt). No destructive prep required', 'Surface can be varnished or unvarnished. Thick varnish layers may attenuate ultrasound slightly but generally transparent to PAI', 'Acoustic coupling gel must be removable (water-soluble preferred)', 'Air gaps between transducer and surface drastically reduce signal (ultrasound reflects at air interfaces)', 'Surface roughness >1 mm can degrade coupling', 'Protective barriers (plastic film) can be used if direct gel contact unacceptable']", 'measurement_protocol': {'preparation': ["['Sampling required: No - in-situ or sample size: few cm² to meters² (depends on system); no size limits in principle', 'For benchtop: place painting or sample horizontally on stage. For handheld: position probe against vertical surface (mural, panel)', 'Apply acoustic coupling medium (ultrasound gel or dry coupling pad) between transducer and surface', 'Ensure good contact without air gaps', 'Clean surface (remove loose dirt). No destructive prep required', 'Surface can be varnished or unvarnished. Thick varnish layers may attenuate ultrasound slightly but generally transparent to PAI', 'Acoustic coupling gel must be removable (water-soluble preferred)', 'Air gaps between transducer and surface drastically reduce signal (ultrasound reflects at air interfaces)', 'Surface roughness >1 mm can degrade coupling', 'Protective barriers (plastic film) can be used if direct gel contact unacceptable']"], 'data_collection': ['**STEP 1: System Calibration and Laser Alignment (20-30 minutes)**\n- Power on laser and allow warm-up (10-20 minutes for stable output)\n- Verify pulse energy with power meter: adjust to 10-50 mJ/pulse depending on target depth and material sensitivity\n- Align laser beam to illuminate sample surface uniformly\n- Verify beam profile with beam profiler or burn paper\n- Position ultrasound transducer to receive acoustic signals\n- Critical parameters: Pulse energy stable (±5% shot-to-shot), Uniform illumination, Transducer aligned with illuminated region\n\n**STEP 2: Acoustic Coupling Setup (5-10 minutes)**\n- Apply ultrasound gel liberally to transducer face and sample surface\n- Position transducer in gentle contact - too much pressure can deform soft materials\n- Verify acoustic coupling by checking for strong surface reflection in A-scan (first arrival peak)\n- If poor coupling, reapply gel and adjust pressure\n- Critical parameters: No air bubbles in gel, Good surface reflection peak visible, Transducer stable and not slipping\n\n**STEP 3: Initial A-Scan Acquisition (Single Point) (5-10 minutes)**\n- Trigger laser and acquire acoustic A-scan (pressure vs. time)\n- Typical acquisition: 10-100 μs time window (corresponding to 7.5-75 mm depth in paint at 1500 m/s sound speed)\n- Average 10-100 laser shots to improve SNR\n- Inspect A-scan: first peak = surface; subsequent peaks = subsurface absorbers\n- Verify depth calibration using known structure\n- Critical parameters: Sufficient time window to capture full depth range, SNR adequate (>10:1), Trigger timing correct (no missing data)\n\n**STEP 4: Optimization of Acquisition Parameters (15-30 minutes)**\n- Optimize laser fluence (energy per area) for maximum SNR without damage\n- Test: gradually increase fluence while monitoring A-scan amplitude - should increase linearly\n- If saturation or damage occurs, reduce fluence\n- Optimize averaging: more averages = higher SNR but slower\n- Set gain on preamplifier to use full dynamic range without saturation\n- Critical parameters: No sample damage visible, A-scan peaks not saturated, Background noise <10% of signal\n\n**STEP 5: 2D Raster Scan Acquisition (B-Scan) (10-60 minutes depending on area and step size)**\n- Define scan area (e.g., 50 × 50 mm) and step size (100-500 μm typical)\n- Program motorized stage to raster scan: move to position, fire laser, acquire A-scan, move to next position\n- Typical scan: 100 × 100 points = 10,000 A-scans at 10 Hz laser = 16 minutes\n- Real-time display of PA amplitude map helps verify progress\n- Critical parameters: Consistent coupling throughout scan, No laser energy drift, Complete data acquisition without missed triggers\n\n**STEP 6: Multispectral Acquisition (Optional, 2-4× single-wavelength acquisition time)**\n- For spectroscopic PAI (pigment identification): repeat scan at multiple wavelengths (e.g., 532, 700, 800, 1064 nm)\n- Generate PA spectrum for each spatial location\n- Compare with known pigment absorption spectra to identify materials\n- Requires tunable laser (OPO) or multiple fixed-wavelength lasers\n- Critical parameters: Wavelength calibration accurate, Fluence normalized between wavelengths, No sample movement between wavelength scans\n\n**STEP 7: 3D Volumetric Imaging (Optional, 30 minutes to 3 hours)**\n- For full 3D reconstruction: acquire dense 2D grid of A-scans (C-scan geometry)\n- Each A-scan provides depth profile; together they form 3D volume (x, y, z)\n- Can also use ultrasound arrays with tomographic reconstruction for faster acquisition\n- 3D imaging time: 30 minutes to several hours depending on volume size and resolution\n- Critical parameters: Sufficient spatial sampling (Nyquist criterion), Stable coupling during long acquisition, Large data storage capacity (GB-scale)\n\n**STEP 8: Post-Acquisition Quality Check (10-20 minutes)**\n- Inspect PA images for artifacts: shadowing (complete signal loss below highly absorbing layer), multiple reflections (acoustic reverberations), motion artifacts (streaking)\n- Verify depth scaling is correct by comparing with known layer thicknesses (cross-section measurements if available)\n- Check for photodamage on sample surface'], 'calibration': ['**Standards used:** Absorbing ink layer on glass (known thickness, known absorption coefficient), Carbon nanotube film (strong absorber, homogeneous), Multi-layer phantom with known depths (plastic sheets, paint layers), Tissue-mimicking phantoms (gelatin-based with absorbers).\n\n**Frequency:** Daily: check PA signal from reference absorber. Weekly: depth calibration with multi-layer phantom. Quarterly: full system characterization (sensitivity, resolution).\n\n**Procedure:** Depth calibration: image phantom with layers at known depths (e.g., 0.5, 1.0, 1.5 mm). Measure time delays of PA peaks. Calculate sound speed: v_s = 2 × depth / time. Verify ≈1500 m/s in aqueous materials, ≈2000 m/s in dried paint/canvas. Intensity calibration: measure PA amplitude vs. laser fluence for reference absorber; verify linear relationship.']}, 'data_outputs': '**Raw Data Format:**\n**File Formats:** Binary time-series data (.bin, .dat), HDF5 (hierarchical data format), MATLAB .mat files, DICOM (for clinical systems).\n\n**Data Structure:** A-scan: 1D array (pressure vs. time). B-scan: 2D array (x or y position, time). C-scan: 3D array (x, y, time/depth).\n\n**Typical File Sizes:** A-scan: 10-100 KB (2000 time points × 2 bytes). Full 3D scan (100 × 100 × 2000): 40 MB uncompressed.', 'data_analysis_pipeline': {'preprocessing': '- Baseline subtraction: Remove DC offset from each A-scan. Typically subtract mean of pre-trigger samples. Software: MATLAB, Python\n- Bandpass filtering: Filter to transducer frequency range (e.g., 5-15 MHz for 10 MHz center). Removes low-frequency electrical noise and high-frequency digitization noise. Software: MATLAB (butter, filtfilt), Python (scipy.signal)\n- Hilbert envelope detection: Compute envelope of RF signal to get positive-valued amplitude. Standard in ultrasound imaging. Software: MATLAB (hilbert), Python (scipy.signal)\n- Time-to-depth conversion: Convert time axis to depth: z = v_s × t / 2. Requires knowing sound speed (measure or assume ~1500 m/s). Software: Custom scripts\n- Deconvolution (optional): Remove transducer impulse response to improve axial resolution. Requires measuring or modeling transducer characteristics. Software: MATLAB, Python', 'analysis_workflow': '**STEP 1: Raw Data Import and Visualization**\n- Load A-scan data into analysis software. Display as 2D image: x-axis = lateral position, y-axis = depth (or time). Photoacoustic amplitude shown as grayscale or false color. Initial quality check: verify expected features visible.\n\n**STEP 2: Signal Processing and Enhancement**\n- Apply preprocessing: baseline subtraction, filtering, envelope detection. Adjust dynamic range for optimal visualization (log compression often used). Remove obvious artifacts (bad A-scans from poor coupling).\n\n**STEP 3: Depth Calibration**\n- Identify known features (e.g., surface, canvas-ground interface from cross-section measurements). Measure time delays. Calculate sound speed. Apply depth scaling to entire dataset.\n\n**STEP 4: Layer Identification and Segmentation**\n- Identify distinct PA features: surface peak, underdrawing layers, pigment-rich regions, delamination voids (appear as dark regions - no PA signal). Manually or automatically segment layers. Measure layer thicknesses and depths.\n\n**STEP 5: 3D Volume Rendering (If Applicable)**\n- For 3D data: reconstruct volume showing PA amplitude in 3D. Use volume rendering or isosurface extraction to visualize subsurface structures. Generate fly-through animations. Export cross-sectional slices (XY, XZ, YZ planes).\n\n**STEP 6: Multispectral Analysis (If Applicable)**\n- For spectroscopic PAI: extract PA spectrum at each pixel (PA amplitude vs. wavelength). Compare with reference spectra of known pigments. Use spectral unmixing to quantify pigment concentrations. Generate false-color maps showing pigment distributions.\n\n**STEP 7: Quantitative Measurements**\n- Measure underdrawing depth, layer thicknesses, void sizes. Calculate PA amplitude ratios between regions (indicative of absorption differences). Create depth profiles showing PA intensity vs. depth along selected lines.\n\n**STEP 8: Correlation with Other Techniques**\n- Register PAI images to XRR, IRR, OCT, or cross-section microscopy. Overlay PAI subsurface structure with surface imaging. Validate PAI depth measurements against physical cross-sections where available.'}, 'artifacts_troubleshooting': '**Troubleshooting:**\n- Laser pulse energy stable within ±5% across scan\n- Acoustic coupling maintained (no signal dropout during scan)\n- PA signal scales linearly with fluence (no saturation or nonlinearity)\n- Depth scaling correct (known layer depths match measured)\n- No photodamage visible on sample surface after imaging\n- SNR sufficient (>10:1) for deepest features of interest\n- Trigger timing accurate (no jitter in A-scan start time)\n- Common artifacts: Shadowing - total signal loss below highly absorbing layer (e.g., thick carbon black underdrawing), Reverberation artifacts - multiple reflections between surfaces (parallel interfaces), Clutter - acoustic scattering from material heterogeneities, Limited view artifacts - incomplete angular coverage causes distortion in reconstruction, Motion artifacts - sample or transducer movement during scan creates streaks, Acoustic aberration - sound speed variations distort wavefronts (defocusing)\n- Troubleshooting: No PA signal detected (check gel application; verify laser output with power meter; adjust trigger delay; test transducer with pulse-echo), Very weak signal (increase fluence (check damage); use wavelength matching target absorption; reduce depth of imaging; average more shots), Cannot see deep layers (use longer wavelength (NIR) for deeper penetration; increase fluence; lower acoustic frequency (trades resolution for depth)), Multiple echoes obscure signal (use broadband transducer (reduces ringing); apply acoustic absorber behind sample; signal processing (deconvolution)), Damage to sample surface (reduce fluence immediately; limit number of averages; use longer wavelength; test on mock-up first)', 'multimodal_pairings': '**Complementary Techniques:**\n\n- oct\n\n- x-ray-radiography-film\n\n- irr-nir\n\n- raman-microscopy\n\n- ma-xrf', 'strengths_limitations': {'strengths': ['See technique documentation'], 'limitations': ['See technique documentation']}, 'lab_checklist': ['Laser pulse energy stable within ±5% across scan', 'Acoustic coupling maintained (no signal dropout during scan)', 'PA signal scales linearly with fluence (no saturation or nonlinearity)', 'Depth scaling correct (known layer depths match measured)', 'No photodamage visible on sample surface after imaging', 'SNR sufficient (>10:1) for deepest features of interest', 'Trigger timing accurate (no jitter in A-scan start time)', 'Common artifacts: Shadowing - total signal loss below highly absorbing layer (e.g., thick carbon black underdrawing), Reverberation artifacts - multiple reflections between surfaces (parallel interfaces), Clutter - acoustic scattering from material heterogeneities, Limited view artifacts - incomplete angular coverage causes distortion in reconstruction, Motion artifacts - sample or transducer movement during scan creates streaks, Acoustic aberration - sound speed variations distort wavefronts (defocusing)', 'Troubleshooting: No PA signal detected (check gel application; verify laser output with power meter; adjust trigger delay; test transducer with pulse-echo), Very weak signal (increase fluence (check damage); use wavelength matching target absorption; reduce depth of imaging; average more shots), Cannot see deep layers (use longer wavelength (NIR) for deeper penetration; increase fluence; lower acoustic frequency (trades resolution for depth)), Multiple echoes obscure signal (use broadband transducer (reduces ringing); apply acoustic absorber behind sample; signal processing (deconvolution)), Damage to sample surface (reduce fluence immediately; limit number of averages; use longer wavelength; test on mock-up first)'], 'keywords': ['photoacoustic imaging', 'PAI', 'optoacoustic', 'subsurface imaging', 'ultrasound', 'underdrawing detection', 'depth profiling', 'non-invasive', 'laser', 'hybrid imaging', 'cultural heritage']}
