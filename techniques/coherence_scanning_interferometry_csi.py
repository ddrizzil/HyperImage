"""
Coherence Scanning Interferometry (CSI) technique data definition.
"""

# Data for Coherence Scanning Interferometry (CSI) reference page
coherence_scanning_interferometry_csi_data = {'one_line_summary': 'Coherence Scanning Interferometry (CSI), also known as white-light interferometry or vertical scanning interferometry, is a non-contact optical technique that measures 3D surface topography with nanometer-scale vertical resolution across millimeter-scale fields of view. The method exploits the short coherence length of broadband (white) light to determine surface height: interference fringes appear only when the optical path difference between reference and sample beams is within the coherence envelope (~1-2 μm). By vertically scanning the objective through focus while recording interference patterns at each height, the technique locates the position of maximum fringe contrast (coherence peak) at every pixel, directly mapping surface topography. CSI achieves sub-nanometer vertical resolution (0.1-1 nm RMS) with lateral resolution of 0.5-10 μm, enabling quantitative characterization of surface roughness, wear patterns, toolmarks, weathering, corrosion, and paint texture in heritage objects without contact or damage.', 'abstract': 'Coherence Scanning Interferometry (CSI), also known as white-light interferometry or vertical scanning interferometry, is a non-contact optical technique that measures 3D surface topography with nanometer-scale vertical resolution across millimeter-scale fields of view. The method exploits the short coherence length of broadband (white) light to determine surface height: interference fringes appear only when the optical path difference between reference and sample beams is within the coherence envelope (~1-2 μm). By vertically scanning the objective through focus while recording interference patterns at each height, the technique locates the position of maximum fringe contrast (coherence peak) at every pixel, directly mapping surface topography. CSI achieves sub-nanometer vertical resolution (0.1-1 nm RMS) with lateral resolution of 0.5-10 μm, enabling quantitative characterization of surface roughness, wear patterns, toolmarks, weathering, corrosion, and paint texture in heritage objects without contact or damage.', 'physics_principle': 'CSI is based on low-coherence interferometry in a Michelson or Mirau interferometer configuration. Broadband (white) light from LED or halogen source splits into reference and sample beams. Light reflected from both paths recombines, creating interference fringes only when optical path difference (OPD) is within coherence length l_c = λ²/Δλ (~1-2 μm for white light, where λ is center wavelength and Δλ is spectral bandwidth). As objective scans vertically, each surface point passes through best focus position where OPD = 0, generating maximum fringe contrast (coherence peak). Recording intensity vs. scan position I(x,y,z) at each pixel creates 3D interferogram. Peak location z_peak(x,y) directly gives surface height. Vertical resolution ~λ/100 (~5 nm) from precise peak localization; lateral resolution ~0.5λ/NA from diffraction limit.', 'instruments_components': '**Source:**\nBroadband light source: white LED, halogen lamp, or supercontinuum laser. Center wavelength: 400-700 nm (visible); bandwidth: 100-200 nm (white light); power: 1-100 mW at sample. Photon energy: 1.8-3.1 eV (visible light). Illumination: 0.1-10 mW/cm² at sample (safe, non-damaging). Spatially incoherent (extended source); temporally incoherent (broadband); uniform illumination via Köhler illumination.\n\n**Detector:**\nCCD camera (monochrome, typical), CMOS camera (faster frame rate), or Scientific CMOS (sCMOS, high dynamic range). Sensitive to visible light: 400-700 nm. Quantum efficiency 40-95% depending on sensor type (front-illuminated CCD: ~50%, back-illuminated: >90%). Time resolution: Frame rate: 10-200 fps (determines scan speed); exposure time: 1-100 ms per frame.\n\n**Critical Components:**\n- High-quality interference objective (Mirau or Michelson; precision reference mirror)\n- Vibration isolation (pneumatic table or active isolation; critical for nm-scale measurements)\n- Precision vertical scanning stage (piezo actuator: nm-scale positioning; linear encoder for accuracy)\n- High-sensitivity camera (low noise, high dynamic range for weak fringes)\n- Environmental enclosure (optional: minimize air turbulence, temperature drift)\n- Analysis software (peak finding, phase unwrapping, surface parameter calculation)\n- Calibration artifacts (step height standards, roughness standards)\n\n**Typical Configuration:**\n**Standard CSI setup:** White LED source (λ = 550 ± 150 nm, 5 mW power). Mirau interference objective: 50× magnification, NA = 0.55, working distance = 3.4 mm. Field of view: 280 × 210 μm (with 1280 × 960 pixel camera → 0.22 μm/pixel sampling). Vertical scan range: ±50 μm (100 μm total) at 100 nm steps (500 frames). Scan time: 30 seconds (at 20 fps). Vertical resolution: 0.3 nm RMS. Lateral resolution: 0.6 μm (Rayleigh). Pneumatic vibration isolation table. Analysis: automated peak detection, form removal (tilt, curvature), roughness parameters (ISO 25178).', 'resolution_detection': '**Spatial Resolution:**\nLateral Resolution: 0.5-10 μm (depends on objective NA and wavelength; typical: 1-2 μm with 50× objective). Depth Resolution: 0.1-1 nm RMS vertical resolution (sub-nanometer precision from phase analysis). Limiting factors: Numerical aperture of objective (higher NA = better lateral resolution but shorter working distance), Wavelength of light (shorter λ = better resolution; typically use visible ~400-700 nm), Signal-to-noise ratio (detector sensitivity, vibration, air turbulence affect height precision), Surface reflectivity (low reflectance → weak fringes → poor height determination), Surface slope (steep slopes >30° may exceed NA, causing dropout), Sample vibration and air currents during scan (multi-second acquisition time).\n\n**Interaction Depth:**\nCSI is a pure surface technique measuring only the top reflective interface. Penetration depth effectively zero for opaque materials (measures surface within top ~λ/4 ≈ 100-200 nm). For transparent materials (glass, varnish), multiple interfaces can generate overlapping interferograms, requiring deconvolution or causing measurement artifacts. Opaque metals (bronze, silver, gold): Surface only (~100-200 nm optical penetration), ideal for CSI; single strong reflection from surface. Stone and ceramics: Surface only, sufficient reflectivity; may have local variations in reflectance affecting fringe contrast. Painted surfaces (opaque paint): Paint surface only, measures top of paint layer; cannot penetrate to substrate. Transparent/translucent materials (glass, varnish): Multiple interfaces measured simultaneously, front and back surfaces interfere; requires specialized analysis or thin samples. Paper and parchment: Fiber surface topography, lower reflectivity; may need longer integration or illumination boost. Dark materials (black paint, carbon): Surface only, but low signal, low reflectivity challenges measurement; may need high-sensitivity camera or longer integration.\n\n**Detection Limits:**\nVertical: 0.1 nm RMS (under ideal conditions, calm environment). Lateral features: ~0.5 μm (diffraction limit with high-NA objective). Dynamic range: Vertical: 10 μm - 10 mm (ratio ~10⁵-10⁶); limited by scan range and step size. Lateral: field of view 0.1 × 0.1 mm to 10 × 10 mm. Signal-to-noise: SNR 50-500 typical for well-reflecting surfaces; degrades for low-reflectivity (<10%) or highly scattering surfaces.', 'sample_requirements': "**Destructiveness:** non-destructive\n\n**Portability:** laboratory-based\n\n**Sample Preparation:**\n['Sampling required: No - typically 1-200 mm lateral dimensions; height up to ~50 mm (depends on stage clearance)', 'Place sample on stage. No special mounting needed for flat samples', 'Tilted or irregular objects: use modeling clay, wax, or V-blocks to stabilize', 'Ensure surface approximately horizontal (< 5° tilt acceptable; software corrects)', 'Large objects: may need to bring profiler to object if portable system unavailable', 'No preparation required for most heritage materials', 'Clean surface (remove dust with soft brush or compressed air)', 'No coating, no polishing. Analyze as-is', 'For very dark low-reflectance surfaces: may apply thin developer powder (used in crack detection) to boost reflectivity, though alters true surface', 'Not applicable - CSI measures surface topography, not cross-sections', 'Dust particles appear as spurious height features; remove with gentle cleaning', 'Fingerprints alter local reflectance; handle samples with gloves', 'Loose particles (soil, corrosion flakes) detected as false topography', 'Condensation on cold samples creates reflective water film (false smooth surface)']", 'measurement_protocol': {'preparation': ["['Sampling required: No - typically 1-200 mm lateral dimensions; height up to ~50 mm (depends on stage clearance)', 'Place sample on stage. No special mounting needed for flat samples', 'Tilted or irregular objects: use modeling clay, wax, or V-blocks to stabilize', 'Ensure surface approximately horizontal (< 5° tilt acceptable; software corrects)', 'Large objects: may need to bring profiler to object if portable system unavailable', 'No preparation required for most heritage materials', 'Clean surface (remove dust with soft brush or compressed air)', 'No coating, no polishing. Analyze as-is', 'For very dark low-reflectance surfaces: may apply thin developer powder (used in crack detection) to boost reflectivity, though alters true surface', 'Not applicable - CSI measures surface topography, not cross-sections', 'Dust particles appear as spurious height features; remove with gentle cleaning', 'Fingerprints alter local reflectance; handle samples with gloves', 'Loose particles (soil, corrosion flakes) detected as false topography', 'Condensation on cold samples creates reflective water film (false smooth surface)']"], 'data_collection': ['**STEP 1: Sample Positioning and Coarse Focusing (2-5 minutes)**\n- Place sample on stage. Using live video mode (white-light illumination), navigate to region of interest\n- Adjust XY position to center feature\n- Coarse focus using manual or motorized Z adjustment until surface is approximately in focus (fringes visible)\n- Check that surface is within objective working distance\n- Critical parameters: Surface roughly horizontal (< 5° tilt), Feature of interest centered in field of view, Fringes visible (indicates surface near best focus)\n\n**STEP 2: Objective Selection and Field of View Setup (1-3 minutes)**\n- Select appropriate objective based on trade-off: low magnification (5-10×) for large field (mm-scale), low lateral resolution (~5-10 μm); high magnification (50-100×) for small field (100-500 μm), high lateral resolution (~0.5-1 μm)\n- For rough surfaces: lower NA (longer working distance)\n- For smooth surfaces or fine features: higher NA (better resolution)\n- Critical parameters: Magnification appropriate for feature size, Field of view sufficient to capture area of interest, Working distance adequate for surface roughness\n\n**STEP 3: Scan Parameter Configuration (2-5 minutes)**\n- Set vertical scan range: typically ±50 μm (100 μm total) to ensure capturing all surface heights\n- Set scan speed: slower (5-10 μm/s) for better SNR; faster (20-50 μm/s) for quick survey\n- Set sampling: 50-100 nm step size typical (500-1000 frames for 50 μm scan)\n- Exposure time: adjust based on surface reflectivity (brighter surface → shorter exposure; darker → longer)\n- Frame averaging: 1-4 frames per step for noise reduction\n- Critical parameters: Scan range encompasses all surface heights, Step size adequate for Nyquist sampling (< λ/4 ≈ 130 nm), Exposure time optimized (no saturation, sufficient signal)\n\n**STEP 4: Test Scan (1-2 minutes)**\n- Acquire short test scan (~10 μm range, 5-10 seconds) to verify settings\n- Inspect reconstructed surface: Are there valid data across field? Any dropout regions (insufficient signal)? Surface tilt reasonable? Fringes well-contrasted?\n- Adjust exposure, scan range, or focusing if needed\n- Critical parameters: Valid height data >90% of pixels, No saturation (blown highlights), Surface features visible and reasonable\n\n**STEP 5: Full Measurement Acquisition (30 seconds to 5 minutes)**\n- Start full CSI scan. System automatically: (1) Moves objective/sample through vertical range in discrete steps, (2) Captures camera frame at each step, (3) Stores 3D data cube I(x,y,z)\n- Monitor acquisition for problems: stage jamming, sample vibration, sudden loss of fringes\n- Typical scan time: 30 seconds to 5 minutes depending on range, step size, frame rate\n- Critical parameters: No interruption during scan (vibration, air currents), All frames captured successfully, No drift or sample movement\n\n**STEP 6: Surface Reconstruction (5-30 seconds automatic)**\n- Software processes I(x,y,z) data cube: (1) For each pixel (x,y), analyze intensity vs. z, (2) Locate coherence peak (maximum fringe contrast) → gives surface height h(x,y), (3) Use centroid, parabolic fit, or Fourier analysis for sub-pixel peak localization, (4) Assemble 2D height map z(x,y)\n- Reconstruction typically automatic (1-10 seconds)\n- Inspect for invalid points (dropout due to low reflectance, steep slopes)\n- Critical parameters: Peak detection successful at >95% pixels, No artifacts (spikes, holes) in height map, Height range physically reasonable\n\n**STEP 7: Data Processing and Analysis (5-15 minutes)**\n- Apply processing: (1) Remove outliers (spike removal, median filter), (2) Form removal: subtract tilt (plane fit), curvature (polynomial fit), or reference surface, (3) Set height datum (zero reference)\n- Calculate surface parameters: roughness (Sa, Sq, Sz), texture (Str, Sal), functional (bearing area ratio), fractal dimension\n- Generate visualization: 3D rendering, pseudo-color height map, cross-section profiles\n- Critical parameters: Form removal appropriate (tilt, curvature corrected), Outliers removed without losing real features, Parameters calculated per ISO 25178 standard\n\n**STEP 8: Stitching (Optional, for Large Areas, 10-60 minutes for 10-100 fields)**\n- For areas larger than single field of view: acquire multiple overlapping measurements (10-30% overlap)\n- Software automatically stitches adjacent fields using correlation of overlapping regions\n- Generates seamless large-area topography map (mm to cm scale) with nm vertical resolution\n- Critical parameters: Sufficient overlap between fields (>10%), Sample stable during multi-field acquisition, Stitching algorithm successfully aligns fields\n\n**STEP 9: Export and Documentation (5-10 minutes)**\n- Export height data (ASCII .xyz, .txt; binary .sur; image TIFF)\n- Export analysis report (roughness parameters, statistics, profiles)\n- Save processed images (3D rendering, pseudo-color maps) for publication\n- Archive raw data (full I(x,y,z) cube) for reprocessing if needed'], 'calibration': ['**Standards used:** Step height standard (SiO₂ on Si, certified height: 100 nm, 1 μm, 10 μm, 100 μm), Roughness standard (machined metal, certified Ra/Sq values), Spherical reference (calibrated radius of curvature for lateral calibration), Grating (pitch standard for lateral dimension calibration).\n\n**Frequency:** Daily: check calibration with step height standard. Weekly: full calibration (lateral + vertical). After objective change: verify calibration. Annually: recalibrate with traceable standards (NIST or equivalent).\n\n**Procedure:** Vertical calibration: measure certified step height standard (e.g., 100 nm step). Compare measured to certified value. Adjust software calibration factor if error >2%. Lateral calibration: measure pitch of grating with known spacing (e.g., 10 μm pitch). Verify pixel size. Adjust if needed. Linearity check: measure step heights from 100 nm to 100 μm; verify linear response.']}, 'data_outputs': '**Raw Data Format:**\n**File Formats:** Proprietary formats (.opd, .dat, .zmg), ASCII text (.xyz, .txt: X Y Z columns), TIFF (16-bit, grayscale height map), ISO 5436-2 .sdf (Surface Data File), VK (Keyence format), PLU (Sensofar format).\n\n**Data Structure:** 2D array (height map): z(x,y). Typical dimensions: 640 × 480 to 2048 × 2048 pixels. Height values: 16-bit or 32-bit floating point (nm or μm units).\n\n**Typical File Sizes:** 2-50 MB per measurement (depending on resolution; raw 3D interferogram stack can be 100 MB - 1 GB if saved).', 'data_analysis_pipeline': {'preprocessing': '- Leveling (form removal): Remove tilt (fit plane, subtract) and curvature (fit polynomial, subtract) to isolate roughness from form. Critical for accurate roughness measurement. Software: MountainsMap, Gwyddion, instrument software\n- Outlier removal: Identify and remove/interpolate invalid points: spikes (> 3σ from local mean), holes (missing data). Use median filter or morphological operations. Software: All CSI software packages\n- Height thresholding: Set lower/upper thresholds to exclude non-physical heights (e.g., remove points >10 μm above/below mean if measuring nm-scale roughness). Software: MountainsMap, Gwyddion\n- Filtering (spatial): Apply high-pass, low-pass, or band-pass filter to separate roughness scales. S-filter (Gaussian): removes waviness, isolates roughness. L-filter: removes form, retains waviness + roughness. Software: MountainsMap (ISO 25178 compliant)\n- Stitching (multi-field measurements): Align and merge overlapping fields. Correlation-based or feature-based registration. Blend overlapping regions to create seamless composite. Software: Instrument software, MountainsMap', 'analysis_workflow': '**STEP 1: Data Quality Inspection**\n- Load height map. Visualize as 3D rendering and/or pseudo-color map. Check for: valid data percentage (>95% ideal), outliers (spikes, holes), gross features (tilt, curvature), physical reasonableness. Flag problematic regions for exclusion or re-measurement.\n\n**STEP 2: Form Removal**\n- Remove large-scale form (tilt, curvature) to isolate surface texture. Methods: least-squares plane fit (removes tilt), polynomial fit (2nd-4th order, removes curvature), reference surface subtraction. Verify form removal by inspecting flattened surface (should have ~zero mean, symmetric height distribution).\n\n**STEP 3: Roughness Parameter Calculation**\n- Calculate ISO 25178 areal roughness parameters: Sa (arithmetic mean height), Sq (RMS height), Sz (max peak-to-valley), Ssk (skewness), Sku (kurtosis). Hybrid parameters: Sdq (RMS slope), Sdr (developed surface area ratio). Functional: bearing area curve, void volume. Software computes automatically per standard.\n\n**STEP 4: Texture and Spatial Analysis**\n- Analyze spatial characteristics: Autocorrelation function (ACF, shows texture periodicity), Power spectral density (PSD, shows roughness at different spatial frequencies), Texture aspect ratio (Str, indicates isotropy/anisotropy), Texture direction (Std, dominant lay orientation). Identifies manufacturing signatures (toolmarks, grinding direction).\n\n**STEP 5: Profile Extraction**\n- Extract 2D height profiles along lines of interest (e.g., across brushstroke, perpendicular to toolmarks). Calculate 2D roughness parameters (Ra, Rq, Rz per ISO 4287). Useful for detailed feature characterization and comparison to stylus profilometry.\n\n**STEP 6: Volume and Area Calculation**\n- Calculate material volume above/below datum, void volume, surface area (true 3D surface area vs. projected area). Useful for quantifying material loss (corrosion, erosion), coating thickness, or wear volume.\n\n**STEP 7: Comparative Analysis**\n- Compare measurements: before/after treatment, aged vs. pristine, different materials/conditions. Statistical tests (t-test, ANOVA) on roughness parameters. Generate difference maps (subtract two height maps) to visualize changes.\n\n**STEP 8: Visualization and Reporting**\n- Generate publication-quality figures: 3D renderings (lighting, shading), pseudo-color height maps (perceptually uniform colormaps), profile plots, histograms. Export statistical summary table (roughness parameters with uncertainties). Annotate images with scale bars, height scale.'}, 'artifacts_troubleshooting': '**Troubleshooting:**\n- Interference fringes visible and well-contrasted across field\n- Valid height data at >95% of pixels (< 5% dropout)\n- Surface tilt <5° (correctable by software)\n- No spikes or outliers exceeding physical expectations\n- Repeatability: repeat measurement shows <1 nm RMS difference in Sa/Sq\n- Stitched measurements: smooth transitions at field boundaries\n- Environmental stability: no vibration, air currents, or temperature drift during scan\n- Common artifacts: Batwing effect - bright/dark fringe at edges of steep features (diffraction artifact), Dropout regions - no valid height data due to insufficient reflectance or excessive slope (>30°), 2π ambiguity - sudden ~λ/2 (~275 nm) height jumps due to fringe order error, Vibration ripple - periodic height oscillations across surface from environmental vibration, Ghost fringes - multiple reflections in transparent layers causing spurious peaks, Tilt error - residual tilt from improper form removal creates artificial slope\n- Troubleshooting: No fringes visible / no valid data (adjust focus manually; reduce tilt; increase illumination or exposure; use lower NA objective (longer coherence length)), High percentage of invalid pixels (dropout) (increase exposure time; use lower NA objective; coat surface (if acceptable); measure multiple areas and composite), Spiky artifacts (outliers) (clean sample; adjust peak detection parameters; apply outlier removal filter (spike removal)), Measurement not repeatable (>5 nm RMS variation) (improve vibration isolation; enclose instrument; wait for thermal equilibrium; secure sample better; reduce scan time), Stitching discontinuities (increase overlap (>20%); measure faster; apply global tilt correction before stitching; use drift compensation), Ghost fringes / double peaks (use thinner samples; apply opaque backing; use specialized algorithms for multi-layer analysis; accept limitation for thick transparent coatings)', 'multimodal_pairings': '**Complementary Techniques:**\n\n- optical-microscopy\n\n- sem-secondary-electrons\n\n- afm\n\n- confocal-microscopy\n\n- stylus-profilometry', 'strengths_limitations': {'strengths': ['See technique documentation'], 'limitations': ['See technique documentation']}, 'references': [{'citation': "Davidson, M., et al. 1987. 'An Application of Interference Microscopy to Integrated Circuit Inspection and Metrology.' Proceedings of SPIE 775: 233-247.", 'doi': '10.1117/12.940433'}, {'citation': "de Groot, P., and L. Deck. 1995. 'Surface Profiling by Analysis of White-Light Interferograms in the Spatial Frequency Domain.' Journal of Modern Optics 42 (2): 389-401.", 'doi': '10.1080/09500349514550341'}, {'citation': "Piqué, F., et al. 2018. 'Quantitative Assessment of Marble Surface Weathering Using Coherence Scanning Interferometry: Michelangelo's David.' Heritage Science 6: 28.", 'doi': '10.1186/s40494-018-0194-3'}], 'lab_checklist': ['Interference fringes visible and well-contrasted across field', 'Valid height data at >95% of pixels (< 5% dropout)', 'Surface tilt <5° (correctable by software)', 'No spikes or outliers exceeding physical expectations', 'Repeatability: repeat measurement shows <1 nm RMS difference in Sa/Sq', 'Stitched measurements: smooth transitions at field boundaries', 'Environmental stability: no vibration, air currents, or temperature drift during scan', 'Common artifacts: Batwing effect - bright/dark fringe at edges of steep features (diffraction artifact), Dropout regions - no valid height data due to insufficient reflectance or excessive slope (>30°), 2π ambiguity - sudden ~λ/2 (~275 nm) height jumps due to fringe order error, Vibration ripple - periodic height oscillations across surface from environmental vibration, Ghost fringes - multiple reflections in transparent layers causing spurious peaks, Tilt error - residual tilt from improper form removal creates artificial slope', 'Troubleshooting: No fringes visible / no valid data (adjust focus manually; reduce tilt; increase illumination or exposure; use lower NA objective (longer coherence length)), High percentage of invalid pixels (dropout) (increase exposure time; use lower NA objective; coat surface (if acceptable); measure multiple areas and composite), Spiky artifacts (outliers) (clean sample; adjust peak detection parameters; apply outlier removal filter (spike removal)), Measurement not repeatable (>5 nm RMS variation) (improve vibration isolation; enclose instrument; wait for thermal equilibrium; secure sample better; reduce scan time), Stitching discontinuities (increase overlap (>20%); measure faster; apply global tilt correction before stitching; use drift compensation), Ghost fringes / double peaks (use thinner samples; apply opaque backing; use specialized algorithms for multi-layer analysis; accept limitation for thick transparent coatings)'], 'keywords': ['CSI', 'coherence scanning interferometry', 'white-light interferometry', 'VSI', '3D surface profiling', 'roughness', 'topography', 'non-contact metrology', 'heritage conservation', 'cultural heritage']}
